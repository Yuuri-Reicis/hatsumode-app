<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="バーチャル初詣デート - 一緒に神社を巡り、思い出のスチルを作ろう">
    <title>🏮 バーチャル初詣デート 🏮</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Zen+Maru+Gothic:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- ヘッダー -->
        <header class="header">
            <h1>🏮 バーチャル初詣デート 🏮</h1>
        </header>

        <!-- メインビュー -->
        <main class="main-view" id="mainView">
            <!-- 背景画像 -->
            <div class="background-container" id="backgroundContainer">
                <img src="assets/bg/torii.png" alt="神社背景" id="backgroundImage" class="background-image">

                <!-- 配置された画像のコンテナ -->
                <div class="placed-images-container" id="placedImagesContainer"></div>

                <!-- セリフ表示エリア -->
                <div class="dialogue-box" id="dialogueBox">
                    <div class="dialogue-name" id="dialogueName"></div>
                    <div class="dialogue-text" id="dialogueText"></div>
                </div>

                <!-- 移動ナビゲーション（背景の上にオーバーレイ） -->
                <nav class="navigation">
                    <button class="nav-btn" id="prevBtn">
                        <span class="nav-arrow">◀</span>
                        <span class="nav-label">前へ</span>
                    </button>
                    <div class="location-indicator">
                        <span class="location-icon">📍</span>
                        <span class="location-name" id="locationName">鳥居</span>
                    </div>
                    <button class="nav-btn" id="locationOmikujiBtn"
                        style="display: none; background: rgba(180, 80, 80, 0.7); border-radius: 20px; padding: 0.5rem 1rem;">
                        <span class="nav-label">🎋 おみくじ</span>
                    </button>
                    <button class="nav-btn" id="nextBtn">
                        <span class="nav-label">次へ</span>
                        <span class="nav-arrow">▶</span>
                    </button>
                </nav>
            </div>
        </main>

        <!-- 折りたたみメニュー -->
        <div class="collapsible-menu" id="collapsibleMenu">
            <!-- 折りたたみトグルボタン -->
            <button class="menu-toggle" id="menuToggle">
                <span class="toggle-icon">▼</span>
                <span class="toggle-label">メニュー</span>
            </button>

            <div class="menu-content" id="menuContent">
                <!-- セリフ入力パネル -->
                <div class="dialogue-input-panel">
                    <div class="input-group">
                        <input type="text" id="nameInput" placeholder="名前" class="name-input" maxlength="20">
                        <input type="text" id="textInput" placeholder="セリフを入力..." class="text-input" maxlength="100">
                        <button class="apply-btn" id="applyDialogue">表示</button>
                        <button class="clear-btn" id="clearDialogue">消す</button>
                    </div>
                </div>

                <!-- ツールバー -->
                <div class="toolbar">
                    <button class="tool-btn" id="saveBtn">
                        <span class="tool-icon">📷</span>
                        <span class="tool-label">スチル保存</span>
                    </button>
                    <label class="tool-btn" id="addImageBtn">
                        <span class="tool-icon">🖼️</span>
                        <span class="tool-label">画像追加</span>
                        <input type="file" id="imageInput" accept="image/*" multiple hidden>
                    </label>
                    <button class="tool-btn" id="omikujiBtn">
                        <span class="tool-icon">🎴</span>
                        <span class="tool-label">おみくじ</span>
                    </button>
                    <button class="tool-btn danger" id="clearImagesBtn">
                        <span class="tool-icon">🗑️</span>
                        <span class="tool-label">画像削除</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- おみくじモーダル -->
        <div class="modal-overlay" id="omikujiModal">
            <div class="modal-content omikuji-modal">
                <!-- タイプ選択ボタン -->
                <div class="omikuji-type-selector">
                    <button class="type-btn active" id="omikujiUserBtn" onclick="setOmikujiType('user')">
                        👤 あなた用
                    </button>
                    <button class="type-btn" id="omikujiAiBtn" onclick="setOmikujiType('ai')">
                        🤖 パートナー用
                    </button>
                </div>

                <div class="omikuji-container">
                    <div class="omikuji-box" id="omikujiBox">
                        <div class="omikuji-front">
                            <span>おみくじ</span>
                        </div>
                        <div class="omikuji-back" id="omikujiResult">
                            <div class="omikuji-fortune" id="omikujiFortune">大吉</div>
                            <div class="omikuji-message" id="omikujiMessage"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 画像操作用UI（選択時に表示） -->
        <div class="image-controls" id="imageControls"
            style="display: none; position: fixed; bottom: 20px; left: 550px; z-index: 900;">
            <button class="control-btn" id="scaleUp">＋</button>
            <button class="control-btn" id="scaleDown">－</button>
            <button class="control-btn" id="bringFront">前面</button>
            <button class="control-btn" id="sendBack">背面</button>
            <button class="control-btn danger" id="deleteImage">削除</button>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="script.js"></script>
</body>

</html>